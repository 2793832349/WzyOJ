import{z,y as q,r as v,o as y,G as w,m as o,n as t,w as n,Q as x,aA as C,C as r,l as R,L as U,A as h,D as B,E as V}from"./index.eb4377b0.1766986584207.js";import{M as A}from"./MdEditor.164db853.1766986584207.js";import{_ as D}from"./captcha.18127446.1766986584207.js";import{_ as E}from"./Divider.97fa3e74.1766986584207.js";import{_ as I}from"./Input.4c626101.1766986584207.js";import{a as M,N as $}from"./RadioGroup.668f9840.1766986584207.js";import"./FormItem.d0d13dbd.1766986584207.js";import"./Eye.1e3444f4.1766986584207.js";const G=o("h2",null,"\u8BA8\u8BBA\u6807\u9898",-1),F=o("h2",null,"\u5173\u8054\u5185\u5BB9",-1),L=o("h2",null,"\u8BA8\u8BBA\u6B63\u6587",-1),W={__name:"edit",setup(Q){const s=z(),_=q(),c=s.params.id,e=v({related_content_type:"none",related_content_id:null,title:"",content:"",captcha:""}),f=v(null);s.query.related_problem__id?(e.value.related_content_type="problem",e.value.related_content_id=s.query.related_problem__id):s.query.related_contest__id&&(e.value.related_content_type="contest",e.value.related_content_id=s.query.related_contest__id);const i=v(!1),b=async()=>{if(e.value.title){if(e.value.related_content_type!=="none"&&isNaN(parseInt(e.value.related_content_id))){_.warning("\u5173\u8054\u5185\u5BB9ID\u4E0D\u80FD\u4E3A\u7A7A");return}}else{_.warning("\u8BA8\u8BBA\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A");return}if(!await f.value.checkCaptcha())return;i.value=!0;let d;c?d=h.put(`/discussion/${c}/`,data):d=h.post("/discussion/",e.value),d.then(a=>{c?_.success("\u4FEE\u6539\u6210\u529F"):(_.success("\u521B\u5EFA\u6210\u529F"),B.push({name:"discussion_detail",params:{id:a.id}}))}).finally(()=>{i.value=!1})};return(d,a)=>{const u=C,p=E,g=I,m=M,N=$,k=V;return y(),w(x,null,[o("h1",null,[t(u,{style:{"align-items":"center"},size:"large"},{default:n(()=>[r(" \u521B\u5EFA\u8BA8\u8BBA ")]),_:1})]),t(p),t(u,{vertical:"",size:"large"},{default:n(()=>[o("div",null,[G,t(g,{value:e.value.title,"onUpdate:value":a[0]||(a[0]=l=>e.value.title=l),placeholder:"\u8BF7\u8F93\u5165\u6807\u9898",size:"large"},null,8,["value"])]),o("div",null,[F,t(u,{vertical:"",size:"large"},{default:n(()=>[t(N,{value:e.value.related_content_type,"onUpdate:value":a[1]||(a[1]=l=>e.value.related_content_type=l),name:"radiogroup"},{default:n(()=>[t(u,null,{default:n(()=>[t(m,{value:"none"},{default:n(()=>[r("\u65E0")]),_:1}),t(m,{value:"problem"},{default:n(()=>[r("\u9898\u76EE")]),_:1}),t(m,{value:"contest"},{default:n(()=>[r("\u6BD4\u8D5B\uFF08\u9898\u5355\uFF09")]),_:1})]),_:1})]),_:1},8,["value"]),e.value.related_content_type!=="none"?(y(),R(g,{key:0,value:e.value.related_content_id,"onUpdate:value":a[2]||(a[2]=l=>e.value.related_content_id=l),placeholder:`\u8BF7\u8F93\u5165${e.value.related_content_type==="problem"?"\u95EE\u9898":"\u6BD4\u8D5B\uFF08\u9898\u5355\uFF09"}ID`},null,8,["value","placeholder"])):U("",!0)]),_:1})]),o("div",null,[L,t(A,{content:e.value.content,"onUpdate:content":a[3]||(a[3]=l=>e.value.content=l)},null,8,["content"])])]),_:1}),t(p),t(D,{scene:"discussion",captcha:e.value.captcha,"onUpdate:captcha":a[4]||(a[4]=l=>e.value.captcha=l),ref_key:"captchaRef",ref:f},null,8,["captcha"]),t(p),t(u,null,{default:n(()=>[t(k,{type:"primary",size:"large",onClick:b,loading:i.value,disabled:i.value},{default:n(()=>[r(" \u4FDD\u5B58 ")]),_:1},8,["loading","disabled"])]),_:1})],64)}}};export{W as default};
