import{ay as ee,z as te,y as ae,r as C,F as oe,a0 as se,cv as ne,o as u,G as x,m as D,J as d,l as i,w as e,L as _,n as s,Q as P,A as T,E as le,s as j,C as c,bI as G,p as ue,v as ce,t as h,bJ as de,bK as ie,_ as _e,aA as re}from"./index.eb4377b0.1766986584207.js";import{f as pe,a as me}from"./utils.2f0dea37.1766986584207.js";import{j as m,n as fe,a as ve}from"./consts.72579ead.1766986584207.js";import{_ as B,a as ge}from"./CodeWithCard.0ea28ffe.1766986584207.js";import{S as he}from"./SubmissionTable.534df1c8.1766986584207.js";import{_ as be,a as ye}from"./CollapseItem.5cda8d00.1766986584207.js";import{a as ke,_ as we}from"./Checkbox.7ca0c7f4.1766986584207.js";import{_ as Ce}from"./LayoutContent.6fc7b93d.1766986584207.js";import{_ as xe}from"./Spin.3ae5ee7d.1766986584207.js";import{_ as $e}from"./Scrollbar.be2baf78.1766986584207.js";import{_ as Ae}from"./Tag.ff1efa14.1766986584207.js";import"./Time.2d3501e9.1766986584207.js";import"./index.225da447.1766986584207.js";import"./Eye.1e3444f4.1766986584207.js";import"./DataTable.8d4e61d5.1766986584207.js";import"./ArrowDown.1ae467bd.1766986584207.js";import"./RadioGroup.668f9840.1766986584207.js";import"./Input.4c626101.1766986584207.js";import"./Tooltip.2d4fe76d.1766986584207.js";import"./Select.324054db.1766986584207.js";import"./Forward.bac4cf6f.1766986584207.js";const Ee="/assets/sound.a3a25345.wav";const Se=$=>(de("data-v-ffe245d0"),$=$(),ie(),$),Te={style:{display:"flex","align-items":"center","justify-content":"space-between","margin-bottom":"10px"}},De=Se(()=>D("h1",null,"\u63D0\u4EA4\u8BE6\u60C5",-1)),Ie={style:{"padding-bottom":"15px"}},ze={style:{"padding-bottom":"15px"}},Ne={key:0},Pe={key:1},je={__name:"_id",setup($){const H=te(),F=ae(),b=H.params.id,l=C({}),r=C({}),f=C(!1),v=C([]),A=C([]);let y,k;const L=()=>(k||(k=new Audio(Ee),k.preload="auto"),k),K=async()=>{const t=L();try{t.currentTime=0}catch{}try{await t.play()}catch{}},V=()=>{const t=L();try{t.muted=!0;const a=t.play();a&&typeof a.then=="function"?a.then(()=>{t.pause(),t.currentTime=0,t.muted=!1}).catch(()=>{t.muted=!1}):(t.pause(),t.currentTime=0,t.muted=!1)}catch{}};oe(()=>{window.addEventListener("pointerdown",V,{once:!0})});const O=async()=>{(await T.get(`/submission/${b}/status/`)).status>-3&&(clearInterval(y),E())},E=()=>{T.get(`/submission/${b}/`).then(t=>{v.value=[];for(const a of t.detail)typeof a.subcheck=="number"&&(f.value=!0),f.value&&!v.value.includes(a.subcheck)&&v.value.push(a.subcheck);f.value&&(v.value.sort((a,n)=>a<n),A.value=v.value,t.detail.sort((a,n)=>a.subcheck!==n.subcheck?Number(a.subcheck)<Number(n.subcheck):a.case_name<n.case_name)),l.value=t,t.status<=-3&&(y&&clearInterval(y),y=setInterval(O,1e3))})};E(),se(()=>l.value.status,(t,a)=>{a===void 0||t===void 0||a!==m.ACCEPTED&&t===m.ACCEPTED&&K()}),ne((t,a,n)=>{clearInterval(y),window.removeEventListener("pointerdown",V),k=void 0,n()});const Q=({name:t,expanded:a})=>{r.value[t]||(r.value[t]={},T.get(`/submission/${b}/test-point/${t}/`).then(n=>{r.value[t]=n}))},I=(t,a,n)=>{n.stopPropagation();const S=`/api/submission/${b}/test-point/${t}/?mode=fetch&file=${a}`,g=document.createElement("a");g.href=S,g.setAttribute("download",`${t}.${a}`),document.body.appendChild(g),g.click()},q=(t,a=void 0)=>{a&&a.stopPropagation();const n=document.createElement("textarea");n.value=t,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),F.success("\u590D\u5236\u6210\u529F")},W=()=>{T.post(`/submission/${b}/rejudge/`).then(()=>{F.success("\u5DF2\u5F00\u59CB\u91CD\u65B0\u8BC4\u6D4B"),E()})};return(t,a)=>{const n=le,S=xe,g=Ce,M=ge,R=$e,J=_e,p=ye,X=ke,z=re,Y=we,U=Ae,N=be;return u(),x(P,null,[D("div",Te,[De,d(j).state.user.permissions&&d(j).state.user.permissions.includes("submission")?(u(),i(n,{key:0,type:"warning",onClick:W},{default:e(()=>[c(" \u91CD\u65B0\u8BC4\u6D4B ")]),_:1})):_("",!0)]),l.value.id?(u(),i(g,{key:0},{default:e(()=>[s(S,{show:l.value.status<=-3},{description:e(()=>[c("\u6B63\u5728\u8BC4\u6D4B\u4E2D...")]),default:e(()=>[s(he,{data:[l.value],onRefresh:E},null,8,["data"])]),_:1},8,["show"])]),_:1})):_("",!0),s(N,{style:{"margin-top":"20px",height:"100%"},"default-expanded-names":["code","log"],"display-directive":"show"},{default:e(()=>[s(p,{name:"code"},{header:e(()=>[c(" \u6E90\u4EE3\u7801 "),s(n,{size:"small",class:"case-download-button",onClick:a[0]||(a[0]=o=>q(l.value.source,o))},{default:e(()=>[c(" \u590D\u5236 ")]),_:1})]),default:e(()=>[s(J,null,{default:e(()=>[s(R,{"x-scrollable":"",style:{"margin-bottom":"-10px"}},{default:e(()=>[D("div",Ie,[l.value.language?(u(),i(M,{key:0,code:l.value.source,language:l.value.language,"show-line-numbers":""},null,8,["code","language"])):_("",!0)])]),_:1})]),_:1})]),_:1}),l.value.log?(u(),i(p,{key:0,title:"\u65E5\u5FD7",name:"log"},{default:e(()=>[s(J,null,{default:e(()=>[s(R,{"x-scrollable":"",style:{"margin-bottom":"-10px"}},{default:e(()=>[D("div",ze,[s(M,{code:l.value.log},null,8,["code"])])]),_:1})]),_:1})]),_:1})):_("",!0),l.value.detail&&l.value.detail.length?(u(),i(p,{key:1,title:"\u6D4B\u8BD5\u70B9",name:"test_point"},{default:e(()=>[f.value?(u(),i(Y,{key:0,value:A.value,"onUpdate:value":a[1]||(a[1]=o=>A.value=o)},{default:e(()=>[s(z,{"item-style":"display: flex",style:{"margin-left":"32px","margin-bottom":"20px"}},{default:e(()=>[c(" \u663E\u793A\u6346\u7ED1\u6D4B\u8BD5\uFF1A "),(u(!0),x(P,null,G(v.value,o=>(u(),i(X,{key:o,value:o,label:o},null,8,["value","label"]))),128))]),_:1})]),_:1},8,["value"])):_("",!0),s(N,{onItemHeaderClick:Q},{default:e(()=>[(u(!0),x(P,null,G(l.value.detail,(o,Z)=>ue((u(),i(p,{name:o.case_name,key:Z,disabled:!l.value.allow_download},{header:e(()=>[s(z,null,{default:e(()=>[c(" \u6D4B\u8BD5\u70B9 "+h(o.case_name)+" ",1),f.value?(u(),i(U,{key:0,size:"small",type:"info"},{default:e(()=>[c(" \u6346\u7ED1\u6D4B\u8BD5 "+h(o.subcheck),1)]),_:2},1024)):_("",!0)]),_:2},1024)]),"header-extra":e(()=>[s(z,null,{default:e(()=>[s(U,{style:{padding:"0 10px"},color:{color:d(m).getColorClass(o.status),borderColor:d(m).getColorClass(o.status),textColor:d(j).state.theme==="dark"?"#000":"#FFF"}},{default:e(()=>[c(h(d(m).getDisplay(o.status)),1)]),_:2},1032,["color"]),d(fe).includes(o.status)?_("",!0):(u(),x("span",Ne,h(d(pe)(o.statistics.time)),1)),d(ve).includes(o.status)?_("",!0):(u(),x("span",Pe,h(d(me)(o.statistics.memory)),1))]),_:2},1024)]),default:e(()=>[s(S,{show:!(r.value[o.case_name]&&r.value[o.case_name].in)},{default:e(()=>[s(N,{"default-expanded-names":["in","out","ans"]},{default:e(()=>[s(p,{title:"\u8F93\u5165",name:"in"},{header:e(()=>[c(" \u8F93\u5165 "),s(n,{size:"small",class:"case-download-button",onClick:w=>I(o.case_name,"in",w)},{default:e(()=>[c(" \u4E0B\u8F7D ")]),_:2},1032,["onClick"])]),default:e(()=>[s(B,{code:r.value[o.case_name].in},null,8,["code"])]),_:2},1024),o.status!==d(m).ACCEPTED?(u(),i(p,{key:0,name:"out"},{header:e(()=>[c(" \u8F93\u51FA "),s(n,{size:"small",class:"case-download-button",onClick:w=>I(o.case_name,"out",w)},{default:e(()=>[c(" \u4E0B\u8F7D ")]),_:2},1032,["onClick"])]),default:e(()=>[s(B,{code:r.value[o.case_name].out},null,8,["code"])]),_:2},1024)):_("",!0),s(p,{name:"ans"},{header:e(()=>[c(h(o.status===d(m).ACCEPTED?"\u8F93\u51FA / \u9884\u671F\u8F93\u51FA":" \u9884\u671F\u8F93\u51FA")+" ",1),s(n,{size:"small",class:"case-download-button",onClick:w=>I(o.case_name,"ans",w)},{default:e(()=>[c(" \u4E0B\u8F7D ")]),_:2},1032,["onClick"])]),default:e(()=>[s(B,{code:r.value[o.case_name].ans},null,8,["code"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["show"])]),_:2},1032,["name","disabled"])),[[ce,!f.value||A.value.includes(o.subcheck)]])),128))]),_:1})]),_:1})):_("",!0)]),_:1})],64)}}},ot=ee(je,[["__scopeId","data-v-ffe245d0"]]);export{ot as default};
