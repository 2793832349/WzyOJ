import{ay as L,z as J,y as K,r as f,o,G as l,m as u,t as g,n as t,w as a,Q as P,A as w,aC as q,C as s,L as i,l as b,J as D,s as x,D as N,E as F,_ as G,aA as O,aK as Q,bJ as U,bK as W}from"./index.eb4377b0.1766986584207.js";import{M as X}from"./MdEditor.164db853.1766986584207.js";import{P as Y}from"./ProblemTable.6d141f6b.1766986584207.js";import{R as Z,_ as ee}from"./RankingTable.777cd9c0.1766986584207.js";import{_ as te}from"./Time.2d3501e9.1766986584207.js";import{_ as ne,a as ae}from"./Tabs.ad385494.1766986584207.js";import{_ as oe}from"./LayoutContent.6fc7b93d.1766986584207.js";import"./consts.72579ead.1766986584207.js";import"./CheckCircleTwotone.04f14e2a.1766986584207.js";import"./DataTable.8d4e61d5.1766986584207.js";import"./ArrowDown.1ae467bd.1766986584207.js";import"./Checkbox.7ca0c7f4.1766986584207.js";import"./RadioGroup.668f9840.1766986584207.js";import"./Input.4c626101.1766986584207.js";import"./Eye.1e3444f4.1766986584207.js";import"./Tooltip.2d4fe76d.1766986584207.js";import"./Select.324054db.1766986584207.js";import"./Tag.ff1efa14.1766986584207.js";import"./Forward.bac4cf6f.1766986584207.js";import"./Spin.3ae5ee7d.1766986584207.js";import"./index.225da447.1766986584207.js";import"./Add.3491e10c.1766986584207.js";const $=p=>(U("data-v-0663e88b"),p=p(),W(),p),se={key:0,style:{"font-size":"medium"}},ie={key:0},le={key:1},_e=$(()=>u("div",null,null,-1)),ue={key:0},me=$(()=>u("h2",null,"\u64CD\u4F5C",-1)),re={key:1},de=$(()=>u("h2",null,"\u6BD4\u8D5B\u65F6\u95F4",-1)),pe={key:0,style:{"font-size":"medium"}},ce={key:2},ve={key:0,style:{"font-size":"medium"}},fe={__name:"_id",setup(p){const B=J(),R=K(),m=B.params.id,e=f({problems:[]}),c=f("\u6BD4\u8D5B"),y=f({}),r=f(!1),v=(n=!1)=>{r.value=!0,w.get(`/contest/${m}/ranking/`,{params:{force_update:n}}).then(_=>{y.value=_}).finally(()=>{r.value=!1})},C=()=>{w.get(`/contest/${m}/`).then(n=>{n.start_time=n.start_time&&Number(new Date(n.start_time))||0,n.end_time=n.end_time&&Number(new Date(n.end_time))||0,e.value=n,!n.problem_list_mode&&n.start_time<=Date.now()?v():setTimeout(v,n.start_time-Date.now()),c.value=n.problem_list_mode?"\u9898\u5355":"\u6BD4\u8D5B"})};C();const H=n=>n==="discussion"?(N.push({name:"discussion_list",query:{related_contest__id:m}}),!1):n==="edit"?(N.push({name:"contest_edit",params:{id:m}}),!1):!0,I=()=>{w.post(`/contest/${m}/sign_up/`).then(n=>{R.success("\u62A5\u540D\u6210\u529F"),C()})};return(n,_)=>{const M=ee,k=F,h=te,S=G,T=O,d=ne,z=Q,V=ae,j=oe,A=q;return o(),l(P,null,[u("div",null,[u("h1",null,"#"+g(e.value.id)+"\u2002"+g(e.value.title),1)]),t(A,{"has-sider":""},{default:a(()=>[t(j,null,{default:a(()=>[t(V,{type:"line",size:"large","tabs-padding":20,onBeforeLeave:H},{suffix:a(()=>[e.value.problem_list_mode?i("",!0):(o(),l("div",se,[e.value.start_time&&e.value.start_time>Date.now()?(o(),l("span",ie,[s(" \u8DDD\u79BB\u6BD4\u8D5B\u5F00\u59CB\u8FD8\u6709\uFF1A"),t(M,{duration:e.value.start_time-Date.now()},null,8,["duration"])])):e.value.end_time&&e.value.end_time>Date.now()?(o(),l("span",le,[s(" \u8DDD\u79BB\u6BD4\u8D5B\u7ED3\u675F\u8FD8\u6709\uFF1A"),t(M,{duration:e.value.end_time-Date.now()},null,8,["duration"])])):i("",!0)]))]),default:a(()=>[t(d,{name:"description",tab:c.value+"\u4FE1\u606F"},{default:a(()=>[t(T,{vertical:"",size:"large"},{default:a(()=>[_e,e.value.joined||e.value.allow_sign_up?(o(),l("div",ue,[me,t(k,{type:"primary",onClick:I,disabled:e.value.joined||Date.now()>e.value.end_time},{default:a(()=>[s(g(e.value.joined?"\u5DF2\u52A0\u5165":"\u62A5\u540D"),1)]),_:1},8,["disabled"])])):i("",!0),e.value.problem_list_mode?i("",!0):(o(),l("div",re,[de,e.value.start_time||e.value.end_time?(o(),l("span",pe,[t(h,{time:e.value.start_time,format:"yyyy-MM-dd HH:mm:ss",style:{"margin-right":"5px"}},null,8,["time"]),s(" ~ "),t(h,{time:e.value.end_time,format:"yyyy-MM-dd HH:mm:ss",style:{"margin-left":"5px"}},null,8,["time"])])):i("",!0)])),e.value.description?(o(),l("div",ce,[u("h2",null,g(c.value)+"\u63CF\u8FF0",1),t(S,{class:"description"},{default:a(()=>[t(X,{content:e.value.description,previewOnly:!0},null,8,["content"])]),_:1})])):i("",!0)]),_:1})]),_:1},8,["tab"]),t(d,{name:"problem",tab:"\u9898\u76EE\u5217\u8868",disabled:!e.value.problems.length},{default:a(()=>[t(Y,{data:e.value.problems},null,8,["data"])]),_:1},8,["disabled"]),e.value.problem_list_mode?i("",!0):(o(),b(d,{key:0,name:"ranking",tab:"\u6392\u884C\u699C"},{default:a(()=>[e.value.start_time<=Date.now()&&Date.now()<=e.value.end_time?(o(),l("p",ve,[s(" \u8BF4\u660E\uFF1A\u6BD4\u8D5B\u6392\u884C\u699C\u4EC5\u7EDF\u8BA1\u6BD4\u8D5B\u6301\u7EED\u65F6\u95F4\u4E2D\u7684\u63D0\u4EA4\uFF0C\u6BCF\u5206\u949F\u66F4\u65B0\u4E00\u6B21\u3002\u4E0A\u6B21\u66F4\u65B0\u65F6\u95F4\uFF1A"),t(h,{time:Number(new Date(y.value.time))},null,8,["time"]),s("\u3002 "),D(x).state.user.permissions.includes("contest")?(o(),b(z,{key:0},{trigger:a(()=>[t(k,{onClick:_[0]||(_[0]=E=>v(!0)),disabled:r.value},{default:a(()=>[s(" \u5F3A\u5236\u66F4\u65B0 ")]),_:1},8,["disabled"])]),default:a(()=>[s(" \u4EC5\u7BA1\u7406\u5458\u53EF\u7528\uFF0C\u5C06\u4F1A\u7ACB\u5373\u5237\u65B0\u6392\u884C\u699C\u7F13\u5B58\uFF0C\u8BE5\u7F13\u5B58\u5BF9\u6240\u6709\u7528\u6237\u751F\u6548\u3002 ")]),_:1})):i("",!0)])):D(x).state.user.permissions.includes("contest")?(o(),b(z,{key:1},{trigger:a(()=>[t(k,{onClick:_[1]||(_[1]=E=>v(!0)),disabled:r.value,style:{"margin-left":"1px"}},{default:a(()=>[s(" \u5F3A\u5236\u66F4\u65B0 ")]),_:1},8,["disabled"])]),default:a(()=>[s(" \u4EC5\u7BA1\u7406\u5458\u53EF\u7528\uFF0C\u5C06\u4F1A\u7ACB\u5373\u5237\u65B0\u6392\u884C\u699C\u7F13\u5B58\uFF0C\u8BE5\u7F13\u5B58\u5BF9\u6240\u6709\u7528\u6237\u751F\u6548\u3002 ")]),_:1})):i("",!0),t(Z,{data:y.value,loading:r.value,style:{"margin-top":"15px"}},null,8,["data","loading"])]),_:1})),t(d,{name:"discussion",tab:"\u8BA8\u8BBA",disabled:e.value.start_time<=Date.now()&&Date.now()<=e.value.end_time},null,8,["disabled"]),D(x).state.user.permissions.includes("contest")?(o(),b(d,{key:1,name:"edit",tab:"\u4FEE\u6539"+c.value},null,8,["tab"])):i("",!0)]),_:1})]),_:1})]),_:1})],64)}}},Ee=L(fe,[["__scopeId","data-v-0663e88b"]]);export{Ee as default};
