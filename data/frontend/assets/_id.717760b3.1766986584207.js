import{d as K,o,G as a,m as s,ay as _e,z as de,y as re,r as p,s as T,aB as ce,t as v,n as e,w as t,Q as B,A as U,D as M,aC as pe,J as D,C as r,bI as q,l as N,L as m,aA as me,_ as ve,E as fe,bJ as he,bK as ge}from"./index.eb4377b0.1766986584207.js";import{M as $}from"./MdEditor.164db853.1766986584207.js";import{l as ye}from"./consts.72579ead.1766986584207.js";import{C as be}from"./CodeMirror.d2e6fff6.1766986584207.js";import{_ as G}from"./CodeWithCard.0ea28ffe.1766986584207.js";import{_ as we}from"./captcha.18127446.1766986584207.js";import{_ as ke,a as xe}from"./Col.ea93e547.1766986584207.js";import{_ as Ce,a as ze}from"./Upload.6cd5da4e.1766986584207.js";import{_ as $e,a as Ae}from"./Tabs.ad385494.1766986584207.js";import{_ as Ie}from"./Switch.f34fe457.1766986584207.js";import{_ as Me}from"./Alert.62d754d7.1766986584207.js";import{_ as Oe,a as Ve}from"./Tag.ff1efa14.1766986584207.js";import{_ as Be}from"./Select.324054db.1766986584207.js";import{_ as De}from"./Input.4c626101.1766986584207.js";import{_ as Se}from"./LayoutContent.6fc7b93d.1766986584207.js";import"./Scrollbar.be2baf78.1766986584207.js";import"./FormItem.d0d13dbd.1766986584207.js";import"./Add.3491e10c.1766986584207.js";import"./utils.83ed917f.1766986584207.js";import"./Eye.1e3444f4.1766986584207.js";import"./Tooltip.2d4fe76d.1766986584207.js";const He={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Le=s("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8s8 3.58 8 8s-3.58 8-8 8zm.5-13H11v6l5.25 3.15l.75-1.23l-4.5-2.67z",fill:"currentColor"},null,-1),Ee=[Le],Te=K({name:"AccessTimeOutlined",render:function(S,w){return o(),a("svg",He,Ee)}}),Ue={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},qe=s("path",{d:"M15 9H9v6h6V9zm-2 4h-2v-2h2v2zm8-2V9h-2V7c0-1.1-.9-2-2-2h-2V3h-2v2h-2V3H9v2H7c-1.1 0-2 .9-2 2v2H3v2h2v2H3v2h2v2c0 1.1.9 2 2 2h2v2h2v-2h2v2h2v-2h2c1.1 0 2-.9 2-2v-2h2v-2h-2v-2h2zm-4 6H7V7h10v10z",fill:"currentColor"},null,-1),Ne=[qe],Re=K({name:"MemoryOutlined",render:function(S,w){return o(),a("svg",Ue,Ne)}});const c=b=>(he("data-v-df986219"),b=b(),ge(),b),Fe=c(()=>s("div",null,null,-1)),Je={key:0},Pe=c(()=>s("h2",null,"\u9898\u76EE\u80CC\u666F",-1)),Qe={key:1},Ge=c(()=>s("h2",null,"\u9898\u76EE\u63CF\u8FF0",-1)),Ke={key:2},je=c(()=>s("h2",null,"\u8F93\u5165\u683C\u5F0F",-1)),We={key:3},Xe=c(()=>s("h2",null,"\u8F93\u51FA\u683C\u5F0F",-1)),Ye={key:4},Ze=c(()=>s("h2",null,"\u6837\u4F8B",-1)),et={key:5},tt=c(()=>s("h2",null,"\u63D0\u793A/\u6570\u636E\u8303\u56F4",-1)),nt={key:6},ot=c(()=>s("h2",null,"\u6587\u4EF6",-1)),lt=c(()=>s("h3",null,"\u8BED\u8A00",-1)),st=c(()=>s("h3",null,"\u662F\u5426\u9690\u85CF",-1)),at=c(()=>s("h3",null,"\u4F60\u5361\u5728\u54EA\uFF1F",-1)),ut=c(()=>s("h3",null,"\u62A5\u9519\u4FE1\u606F\uFF08\u53EF\u9009\uFF09",-1)),it={key:0},_t={key:0},dt={key:1},rt={key:2,style:{"white-space":"pre-wrap"}},ct={key:0,style:{"margin-top":"8px"}},pt={style:{"white-space":"pre-wrap","margin-top":"6px"}},mt={key:3},vt={key:1},ft={__name:"_id",setup(b){const S=de(),w=re(),f=S.params.id,l=p({});(()=>{U.get(`/problem/${f}/`).then(i=>{i.files=i.files.map(u=>({name:u,status:"finished"})),l.value=i}).catch(()=>{w.error("\u9898\u76EE\u4E0D\u5B58\u5728\u6216\u6682\u65F6\u65E0\u6CD5\u67E5\u770B\uFF01"),M.push({name:"problem_list"})})})();const j=i=>i==="submission"?(M.push({name:"submission_list",query:{problem__id:f}}),!1):i==="discussion"?(M.push({name:"discussion_list",query:{related_problem__id:f}}),!1):i==="edit"?(M.push({name:"problem_edit",params:{id:f}}),!1):!0,d=p({source:"",language:T.getters.defaultSubmitLanguage,_is_hidden:!1,captcha:""}),R=p(null),O=p(!1),h=p(""),A=p(""),F=p(""),H=p(""),I=p([]),k=p(!1),W=async()=>{if(!d.value.source){w.warning("\u4EE3\u7801\u4E0D\u80FD\u4E3A\u7A7A");return}!await R.value.checkCaptcha()||(O.value=!0,U.post("/submission/",{problem_id:f,...d.value}).then(i=>{T.commit("setSubmitLanguage",d.value.language),M.push({name:"submission_detail",params:{id:i.id}})}).finally(()=>{O.value=!1}))},X=async()=>{if(!h.value.trim()){w.warning("\u8BF7\u8F93\u5165\u4F60\u7684\u95EE\u9898");return}k.value=!0;const i=h.value,u=A.value;I.value.push({role:"user",content:i,error:u,time:Date.now()}),U.post(`/problem/${f}/tutor/`,{question:h.value,language:d.value.language,code:d.value.source,error:A.value,session_id:H.value}).then(_=>{F.value=_.content,_.session_id&&(H.value=_.session_id),I.value.push({role:"assistant",content:_.content,time:Date.now()}),h.value=""}).finally(()=>{k.value=!1})},J=()=>{h.value="",A.value="",F.value=""},Y=()=>{H.value="",I.value=[],J()},P=(i,u=void 0)=>{u&&u.stopPropagation();const _=document.createElement("textarea");_.value=i,document.body.appendChild(_),_.select(),document.execCommand("copy"),document.body.removeChild(_),w.success("\u590D\u5236\u6210\u529F")},Z=i=>{const u=`/api/problem/${f}/file/${i.name}/`,_=document.createElement("a");_.href=u,_.setAttribute("download",i.name),document.body.appendChild(_),_.click()};return(i,u)=>{const _=ce,V=Oe,x=me,g=ve,C=fe,y=ke,L=xe,ee=Ce,te=ze,z=$e,ne=Be,oe=Ie,Q=De,le=Me,se=Ve,ae=Ae,ue=Se,ie=pe;return o(),a(B,null,[s("h1",null,"#"+v(l.value.id)+"\u2002"+v(l.value.title),1),e(ie,{"has-sider":""},{default:t(()=>[e(ue,null,{default:t(()=>[e(ae,{type:"line",size:"large","tabs-padding":20,onBeforeLeave:j},{default:t(()=>[e(z,{name:"description",tab:"\u9898\u76EE\u63CF\u8FF0"},{default:t(()=>[e(x,{vertical:"",size:"large"},{default:t(()=>[Fe,s("div",null,[e(x,{size:"small"},{default:t(()=>[e(V,{bordered:!1},{icon:t(()=>[e(_,{component:D(Te)},null,8,["component"])]),default:t(()=>[r(v(l.value.time_limit)+" ms ",1)]),_:1}),e(V,{bordered:!1},{icon:t(()=>[e(_,{component:D(Re)},null,8,["component"])]),default:t(()=>[r(v(l.value.memory_limit)+" MB ",1)]),_:1}),(o(!0),a(B,null,q(l.value.tags,n=>(o(),N(V,{key:n.id},{default:t(()=>[r(v(n.name),1)]),_:2},1024))),128))]),_:1})]),l.value.background?(o(),a("div",Je,[Pe,e(g,{class:"description"},{default:t(()=>[e($,{content:l.value.background,previewOnly:""},null,8,["content"])]),_:1})])):m("",!0),l.value.description?(o(),a("div",Qe,[Ge,e(g,{class:"description"},{default:t(()=>[e($,{content:l.value.description,previewOnly:""},null,8,["content"])]),_:1})])):m("",!0),l.value.input_format?(o(),a("div",Ke,[je,e(g,{class:"description"},{default:t(()=>[e($,{content:l.value.input_format,previewOnly:""},null,8,["content"])]),_:1})])):m("",!0),l.value.output_format?(o(),a("div",We,[Xe,e(g,{class:"description"},{default:t(()=>[e($,{content:l.value.output_format,previewOnly:""},null,8,["content"])]),_:1})])):m("",!0),l.value.samples&&l.value.samples.some(n=>n.input||n.output)?(o(),a("div",Ye,[Ze,(o(!0),a(B,null,q(l.value.samples,n=>(o(),a("div",{key:n.index,style:{width:"100%"}},[n.input||n.output?(o(),N(L,{key:0,gutter:12},{default:t(()=>[e(y,{span:11},{default:t(()=>[s("h3",null,[r(" \u6837\u4F8B\u8F93\u5165 #"+v(n.index)+" ",1),e(C,{size:"small",class:"copy-button",onClick:E=>P(n.input)},{default:t(()=>[r(" \u590D\u5236 ")]),_:2},1032,["onClick"])]),e(G,{code:n.input},null,8,["code"])]),_:2},1024),e(y,{span:2}),e(y,{span:11},{default:t(()=>[s("h3",null,[r(" \u6837\u4F8B\u8F93\u51FA #"+v(n.index)+" ",1),e(C,{size:"small",class:"copy-button",onClick:E=>P(n.output)},{default:t(()=>[r(" \u590D\u5236 ")]),_:2},1032,["onClick"])]),e(G,{code:n.output},null,8,["code"])]),_:2},1024)]),_:2},1024)):m("",!0)]))),128))])):m("",!0),l.value.hint?(o(),a("div",et,[tt,e(g,{class:"description"},{default:t(()=>[e($,{content:l.value.hint,previewOnly:""},null,8,["content"])]),_:1})])):m("",!0),l.value.files&&l.value.files.length?(o(),a("div",nt,[ot,e(te,{abstract:"","default-file-list":l.value.files||[],"show-remove-button":!1,"show-download-button":"",onDownload:Z},{default:t(()=>[e(g,null,{default:t(()=>[e(ee)]),_:1})]),_:1},8,["default-file-list"])])):m("",!0)]),_:1})]),_:1}),e(z,{name:"submit",tab:"\u63D0\u4EA4",disabled:!l.value.allow_submit},{default:t(()=>[e(L,null,{default:t(()=>[e(y,{span:16,style:{padding:"0 25px"}},{default:t(()=>[e(be,{code:d.value.source,"onUpdate:code":u[0]||(u[0]=n=>d.value.source=n),language:d.value.language},null,8,["code","language"])]),_:1}),e(y,{span:8,style:{padding:"0 25px"}},{default:t(()=>[e(x,{vertical:"",size:"large",class:"submit-setting"},{default:t(()=>[s("div",null,[lt,e(ne,{value:d.value.language,"onUpdate:value":u[1]||(u[1]=n=>d.value.language=n),size:"large",options:D(ye)},null,8,["value","options"])]),s("div",null,[st,e(oe,{value:d.value._is_hidden,"onUpdate:value":u[2]||(u[2]=n=>d.value._is_hidden=n),size:"large"},null,8,["value"])]),e(we,{scene:"submission",captcha:d.value.captcha,"onUpdate:captcha":u[3]||(u[3]=n=>d.value.captcha=n),ref_key:"captchaRef",ref:R},null,8,["captcha"]),e(C,{type:"primary",size:"large",style:{width:"100%","margin-top":"10px"},onClick:W,loading:O.value,disabled:O.value},{default:t(()=>[r(" \u63D0\u4EA4 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled"]),e(z,{name:"tutor",tab:"AI\u52A9\u6559"},{default:t(()=>[e(L,{gutter:16},{default:t(()=>[e(y,{span:10,style:{padding:"0 25px"}},{default:t(()=>[e(x,{vertical:"",size:"large"},{default:t(()=>[s("div",null,[at,e(Q,{value:h.value,"onUpdate:value":u[4]||(u[4]=n=>h.value=n),type:"textarea",rows:6,placeholder:"\u63CF\u8FF0\u4F60\u7684\u601D\u8DEF\u3001\u4F60\u8BA4\u4E3A\u54EA\u91CC\u4E0D\u5BF9\u3001\u4F60\u5E0C\u671B\u5F97\u5230\u4EC0\u4E48\u63D0\u793A..."},null,8,["value"])]),s("div",null,[ut,e(Q,{value:A.value,"onUpdate:value":u[5]||(u[5]=n=>A.value=n),type:"textarea",rows:4,placeholder:"\u7C98\u8D34\u7F16\u8BD1\u9519\u8BEF/\u8FD0\u884C\u9519\u8BEF/\u8F93\u51FA\u4E0D\u5BF9\u7B49\u4FE1\u606F"},null,8,["value"])]),e(x,null,{default:t(()=>[e(C,{type:"primary",onClick:X,loading:k.value,disabled:k.value},{default:t(()=>[r(" \u83B7\u53D6\u63D0\u793A ")]),_:1},8,["loading","disabled"]),e(C,{onClick:Y,disabled:k.value},{default:t(()=>[r(" \u65B0\u4F1A\u8BDD ")]),_:1},8,["disabled"]),e(C,{onClick:J,disabled:k.value},{default:t(()=>[r(" \u6E05\u7A7A ")]),_:1},8,["disabled"])]),_:1}),e(le,{type:"info"},{default:t(()=>[r(" AI \u53EA\u4F1A\u7ED9\u601D\u8DEF\u4E0E\u5F15\u5BFC\uFF0C\u4E0D\u4F1A\u76F4\u63A5\u63D0\u4F9B\u53EF AC \u7684\u5B8C\u6574\u4EE3\u7801\u3002 ")]),_:1})]),_:1})]),_:1}),e(y,{span:14,style:{padding:"0 25px"}},{default:t(()=>[e(g,{title:"AI \u63D0\u793A","content-style":{padding:"0 20px"}},{default:t(()=>[I.value.length?(o(),a("div",it,[e(x,{vertical:"",size:"large",style:{padding:"12px 0"}},{default:t(()=>[(o(!0),a(B,null,q(I.value,(n,E)=>(o(),a("div",{key:E},[n.role==="user"?(o(),a("h3",_t,"\u6211")):(o(),a("h3",dt,"AI")),n.role==="user"?(o(),a("div",rt,[r(v(n.content)+" ",1),n.error?(o(),a("div",ct,[e(V,{type:"warning"},{default:t(()=>[r("\u62A5\u9519")]),_:1}),s("div",pt,v(n.error),1)])):m("",!0)])):(o(),a("div",mt,[e($,{content:n.content,previewOnly:""},null,8,["content"])]))]))),128))]),_:1})])):(o(),a("div",vt,[e(se,{description:"\u8FD8\u6CA1\u6709\u5BF9\u8BDD"})]))]),_:1})]),_:1})]),_:1})]),_:1}),e(z,{name:"submission",tab:"\u63D0\u4EA4\u8BB0\u5F55"}),e(z,{name:"discussion",tab:"\u8BA8\u8BBA",disabled:l.value.hide_discussions},null,8,["disabled"]),D(T).state.user.permissions.includes("problem")?(o(),N(z,{key:0,name:"edit",tab:"\u4FEE\u6539\u9898\u76EE"})):m("",!0)]),_:1})]),_:1})]),_:1})],64)}}},Ut=_e(ft,[["__scopeId","data-v-df986219"]]);export{Ut as default};
