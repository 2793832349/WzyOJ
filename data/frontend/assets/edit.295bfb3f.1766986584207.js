import{z as F,y as J,r,A as m,o as v,G as M,m as n,n as l,w as o,Q as L,aA as Q,C as p,t as $,J as d,l as C,D as U,L as g,E as T}from"./index.eb4377b0.1766986584207.js";import{M as W}from"./MdEditor.164db853.1766986584207.js";import{a as j,N as K}from"./RadioGroup.668f9840.1766986584207.js";import{_ as X}from"./DatePicker.37cc1863.1766986584207.js";import{_ as Y}from"./text.10f0e60f.1766986584207.js";import{_ as Z}from"./Divider.97fa3e74.1766986584207.js";import{_ as ee}from"./Input.4c626101.1766986584207.js";import{_ as te}from"./Select.324054db.1766986584207.js";import{_ as le}from"./Switch.f34fe457.1766986584207.js";import{_ as ne,a as ae}from"./Col.ea93e547.1766986584207.js";import{_ as oe}from"./Popconfirm.e2002990.1766986584207.js";import"./Eye.1e3444f4.1766986584207.js";import"./index.225da447.1766986584207.js";import"./Forward.bac4cf6f.1766986584207.js";import"./Tag.ff1efa14.1766986584207.js";const se=n("h2",null,"\u6BD4\u8D5B\u540D\u79F0",-1),ue=n("h2",null,"\u6BD4\u8D5B\u63CF\u8FF0",-1),ie={key:0},_e=n("h2",null,"\u8D5B\u5236",-1),re=n("span",null,[n("strong",null,"IOI \u8D5B\u5236")],-1),pe=n("span",{style:{"font-size":"12px",color:"#999"}},"\u5B9E\u65F6\u53CD\u9988 + \u90E8\u5206\u5206 + \u53D6\u6700\u9AD8\u5206",-1),de=n("span",null,[n("strong",null,"OI \u8D5B\u5236")],-1),me=n("span",{style:{"font-size":"12px",color:"#999"}},"\u8D5B\u540E\u53CD\u9988 + \u90E8\u5206\u5206 + \u53D6\u6700\u9AD8\u5206",-1),ve=n("span",null,[n("strong",null,"ACM \u8D5B\u5236")],-1),ce=n("span",{style:{"font-size":"12px",color:"#999"}},"\u5B9E\u65F6\u53CD\u9988 + \u7F5A\u65F6 + AC/WA",-1),fe=n("h2",null,"\u9898\u76EE\u5217\u8868",-1),ge=n("h2",null,"\u4EBA\u5458\u8BBE\u7F6E",-1),ye=n("h3",null,"\u662F\u5426\u5141\u8BB8\u62A5\u540D",-1),he=n("h3",null,"\u53C2\u8D5B\u4EBA\u5458",-1),be=n("h2",null,"\u65F6\u95F4\u8BBE\u7F6E",-1),ze=n("h3",null,"\u6BD4\u8D5B\u65F6\u95F4",-1),we={key:0},ke=n("h2",null,"\u5176\u5B83\u8BBE\u7F6E",-1),xe=n("h3",null,"\u662F\u5426\u9690\u85CF",-1),Me=n("h3",null,"\u516C\u5F00\u6392\u884C\u699C",-1),qe={__name:"edit",setup($e){const S=F(),c=J(),u=S.params.id,a=r({problem_list_mode:!1,rule_type:"IOI",problems:[],users:[],title:"",description:"",is_hidden:!1,allow_sign_up:!0,public_ranking:!1,freeze_time:null}),f=r([Math.floor(Date.now()/36e5)*36e5,Math.floor(Date.now()/36e5)*36e5+864e5]),y=r([]),z=r(!1),B=t=>{if(!t){y.value=[];return}z.value=!0,m.get("/problem/",{params:{search:t}}).then(e=>{e=e.results,y.value=e.map(i=>({label:`#${i.id} | ${i.title}`,value:i.id}))}).finally(()=>{z.value=!1})},h=r([]),w=r(!1),H=t=>{if(!t){h.value=[];return}w.value=!0,m.get("/user/",{params:{search:t}}).then(e=>{e=e.results,h.value=e.map(i=>({label:i.username,value:i.id}))}).finally(()=>{w.value=!1})};u&&m.get(`/contest/${u}/`).then(t=>{y.value=t.problems.map(e=>({label:`#${e.id} | ${e.title}`,value:e.id})),t.problems=t.problems.map(e=>e.id),h.value=t.users.map(e=>({label:e.username,value:e.id})),t.start_time=t.start_time&&Number(new Date(t.start_time))||0,t.end_time=t.end_time&&Number(new Date(t.end_time))||0,f.value=[t.start_time,t.end_time],t.users=t.users.map(e=>e.id),a.value=t});const b=r(!1),V=()=>{const t=a.value;if(t.problem_list_mode=!1,t.start_time=f.value[0],t.end_time=f.value[1],t.title)if(t.start_time&&t.end_time){if(t.start_time&&t.end_time&&t.end_time-t.start_time<6e4){c.warning("\u6BD4\u8D5B\u6301\u7EED\u65F6\u95F4\u4E0D\u80FD\u5C0F\u4E8E60\u79D2");return}}else{c.warning("\u6BD4\u8D5B\u5F00\u59CB\u65F6\u95F4\u548C\u7ED3\u675F\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A");return}else{c.warning("\u6BD4\u8D5B\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A");return}t.start_time=t.start_time&&new Date(t.start_time).toISOString()||null,t.end_time=t.end_time&&new Date(t.end_time).toISOString()||null,t.freeze_time=t.freeze_time&&new Date(t.freeze_time).toISOString()||null,b.value=!0;let e;u?e=m.put(`/contest/${u}/`,t):e=m.post("/contest/",t),e.then(i=>{u?c.success("\u4FEE\u6539\u6210\u529F"):U.push({name:"contest_detail",params:{id:i.id}})}).finally(()=>{b.value=!1})},E=()=>{m.delete(`/contest/${u}/`).then(()=>{c.success("\u5220\u9664\u6210\u529F\uFF01"),U.push({name:"contest_list"})})};return(t,e)=>{const i=T,_=Q,I=Z,P=ee,k=j,R=K,O=te,x=le,A=X,D=Y,N=ne,G=ae,q=oe;return v(),M(L,null,[n("h1",null,[l(_,{style:{"align-items":"center"},size:"large"},{default:o(()=>[p($(d(u)?"\u7F16\u8F91":"\u521B\u5EFA")+"\u6BD4\u8D5B "+$(d(u)?` #${d(u)}`:"")+" ",1),d(u)?(v(),C(i,{key:0,onClick:e[0]||(e[0]=s=>d(U).push({name:"contest_detail",params:{id:d(u)}})),style:{display:"flex","align-items":"center"}},{default:o(()=>[p(" \u8FD4\u56DE ")]),_:1})):g("",!0)]),_:1})]),l(I),l(_,{vertical:"",size:"large"},{default:o(()=>[n("div",null,[se,l(P,{value:a.value.title,"onUpdate:value":e[1]||(e[1]=s=>a.value.title=s),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",size:"large"},null,8,["value"])]),n("div",null,[ue,l(W,{content:a.value.description,"onUpdate:content":e[2]||(e[2]=s=>a.value.description=s)},null,8,["content"])]),a.value.problem_list_mode?g("",!0):(v(),M("div",ie,[_e,l(R,{value:a.value.rule_type,"onUpdate:value":e[3]||(e[3]=s=>a.value.rule_type=s)},{default:o(()=>[l(_,null,{default:o(()=>[l(k,{value:"IOI"},{default:o(()=>[l(_,{vertical:"",size:"small"},{default:o(()=>[re,pe]),_:1})]),_:1}),l(k,{value:"OI"},{default:o(()=>[l(_,{vertical:"",size:"small"},{default:o(()=>[de,me]),_:1})]),_:1}),l(k,{value:"ACM"},{default:o(()=>[l(_,{vertical:"",size:"small"},{default:o(()=>[ve,ce]),_:1})]),_:1})]),_:1})]),_:1},8,["value"])])),n("div",null,[fe,l(O,{value:a.value.problems,"onUpdate:value":e[4]||(e[4]=s=>a.value.problems=s),multiple:"",filterable:"",placeholder:"\u641C\u7D22\u9898\u76EE",options:y.value,loading:z.value,clearable:"",remote:"","clear-filter-after-select":!0,onSearch:B},null,8,["value","options","loading"])]),n("div",null,[ge,ye,l(x,{value:a.value.allow_sign_up,"onUpdate:value":e[5]||(e[5]=s=>a.value.allow_sign_up=s)},null,8,["value"]),he,l(O,{value:a.value.users,"onUpdate:value":e[6]||(e[6]=s=>a.value.users=s),multiple:"",filterable:"",placeholder:"\u641C\u7D22\u7528\u6237",options:h.value,loading:w.value,clearable:"",remote:"","clear-filter-after-select":!0,onSearch:H},null,8,["value","options","loading"])]),n("div",null,[be,ze,l(_,null,{default:o(()=>[l(A,{type:"datetimerange",value:f.value,"onUpdate:value":e[7]||(e[7]=s=>f.value=s),format:"yyyy-MM-dd HH:mm"},null,8,["value"])]),_:1}),a.value.rule_type==="ACM"?(v(),M("h3",we,"\u5C01\u699C\u65F6\u95F4\uFF08\u53EF\u9009\uFF09")):g("",!0),a.value.rule_type==="ACM"?(v(),C(_,{key:1},{default:o(()=>[l(A,{type:"datetime",value:a.value.freeze_time,"onUpdate:value":e[8]||(e[8]=s=>a.value.freeze_time=s),format:"yyyy-MM-dd HH:mm",placeholder:"\u4E0D\u5C01\u699C\u5219\u7559\u7A7A",clearable:""},null,8,["value"]),l(D,{depth:"3",style:{"font-size":"12px"}},{default:o(()=>[p(" \u5C01\u699C\u540E\uFF0C\u666E\u901A\u7528\u6237\u770B\u4E0D\u5230\u5C01\u699C\u65F6\u95F4\u4E4B\u540E\u7684\u63D0\u4EA4\u548C\u6392\u540D\u53D8\u5316 ")]),_:1})]),_:1})):g("",!0)]),n("div",null,[ke,l(G,{style:{padding:"0 1px"}},{default:o(()=>[l(N,{span:4},{default:o(()=>[xe,l(x,{value:a.value.is_hidden,"onUpdate:value":e[9]||(e[9]=s=>a.value.is_hidden=s)},null,8,["value"])]),_:1}),l(N,{span:6},{default:o(()=>[Me,l(x,{value:a.value.public_ranking,"onUpdate:value":e[10]||(e[10]=s=>a.value.public_ranking=s)},null,8,["value"]),l(D,{depth:"3",style:{"font-size":"12px",display:"block","margin-top":"4px"}},{default:o(()=>[p(" \u5F00\u542F\u540E\u672A\u767B\u5F55\u7528\u6237\u4E5F\u53EF\u4EE5\u67E5\u770B\u6392\u884C\u699C ")]),_:1})]),_:1})]),_:1})])]),_:1}),l(I),l(_,null,{default:o(()=>[l(i,{type:"primary",size:"large",onClick:V,loading:b.value,disabled:b.value},{default:o(()=>[p(" \u4FDD\u5B58 ")]),_:1},8,["loading","disabled"]),d(u)?(v(),C(q,{key:0,onPositiveClick:E},{trigger:o(()=>[l(i,{type:"error",size:"large"},{default:o(()=>[p(" \u5220\u9664 ")]),_:1})]),default:o(()=>[p(" \u60A8\u786E\u8BA4\u8981\u5220\u9664\u6BD4\u8D5B "+$(a.value.title)+" \u5417\uFF1F\u8BE5\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\u3002 ",1)]),_:1})):g("",!0)]),_:1})],64)}}};export{qe as default};
