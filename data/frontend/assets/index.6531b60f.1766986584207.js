import{ay as $,o as C,l as U,w as l,n as a,k as r,E as d,az as c,z as Q,r as g,a0 as V,aB as R,A as j,aC as E,m as x,B as y,J as _,C as K,D as J}from"./index.eb4377b0.1766986584207.js";import{_ as L}from"./Time.2d3501e9.1766986584207.js";import{_ as O,a as F}from"./DataTable.8d4e61d5.1766986584207.js";import{_ as G}from"./Spin.3ae5ee7d.1766986584207.js";import{_ as H}from"./utils.2f0dea37.1766986584207.js";import{A as M}from"./AddOutline.cf6c0ed3.1766986584207.js";import{_ as P}from"./Input.4c626101.1766986584207.js";import{_ as W}from"./FormItem.d0d13dbd.1766986584207.js";import{_ as X}from"./Form.f0be8e2f.1766986584207.js";import{_ as Y}from"./LayoutContent.6fc7b93d.1766986584207.js";import"./index.225da447.1766986584207.js";import"./Eye.1e3444f4.1766986584207.js";import"./ArrowDown.1ae467bd.1766986584207.js";import"./Checkbox.7ca0c7f4.1766986584207.js";import"./RadioGroup.668f9840.1766986584207.js";import"./Tooltip.2d4fe76d.1766986584207.js";import"./Select.324054db.1766986584207.js";import"./Tag.ff1efa14.1766986584207.js";import"./Forward.bac4cf6f.1766986584207.js";const Z={__name:"DiscussionTable",props:{data:{type:Array,default:[]},loading:{type:Boolean,default:!1}},setup(b){const u=[{title:"ID",render(e){return r(c,{to:{name:"discussion_detail",params:{id:e.id}}},{default:()=>r(d,{text:!0,size:"small"},{default:()=>String(e.id)+(e.is_hidden?"*":"")})})}},{title:"\u6807\u9898",render(e){return r(c,{to:{name:"discussion_detail",params:{id:e.id}}},{default:()=>r(d,{size:"small",text:!0},{default:()=>e.title})})}},{title:"\u4F5C\u8005",render(e){return r(c,{to:{name:"user_detail",params:{id:e.author.id}}},{default:()=>r(d,{text:!0,size:"small"},{default:()=>e.author.username})})}},{title:"\u5173\u8054\u5185\u5BB9",render(e){return e.related_problem?r(c,{to:{name:"problem_detail",params:{id:e.related_problem.id}}},{default:()=>r(d,{text:!0,size:"small"},{default:()=>e.related_problem.title})}):e.related_contest?r(c,{to:{name:"contest_detail",params:{id:e.related_contest.id}}},{default:()=>r(d,{text:!0,size:"small"},{default:()=>e.related_contest.title})}):"-"}},{title:"\u56DE\u590D\u6570",render(e){return e.reply_count}},{title:"\u6700\u8FD1\u56DE\u590D\u65F6\u95F4",render(e){return r(L,{time:new Date(e.latest_reply_time)})}}];return(e,n)=>{const f=O,p=G;return C(),U(p,{show:b.loading},{default:l(()=>[a(f,{columns:u,data:b.data,bordered:!1},null,8,["data"])]),_:1},8,["show"])}}},ee=$(Z,[["__scopeId","data-v-602d91b5"]]),te=x("h1",null,"\u8BA8\u8BBA\u5217\u8868",-1),ae={style:{display:"inline-block"}},ne={style:{"margin-top":"30px","text-align":"center"}},ke={__name:"index",setup(b){var k,q,w,S;const u=Q(),e=g({pageSize:20,page:1,count:0}),n=g({search:(k=u.query.search)!=null?k:"",related_problem__id:(q=u.query.related_problem__id)!=null?q:"",related_contest__id:(w=u.query.related_contest__id)!=null?w:"",author__username:(S=u.query.author__username)!=null?S:""}),f=g([]),p=g(!1),s=H(n.value,e.value,u),z=()=>{var i;if(u.name==="discussion_list"){for(const t in n.value)n.value[t]=(i=u.query[t])!=null?i:"";for(const t in e.value)u.query[t]&&(e.value[t]=parseInt(u.query[t]));p.value=!0,j.get("/discussion/",{params:{limit:e.value.pageSize,offset:(e.value.page-1)*e.value.pageSize,...n.value}}).then(t=>{e.value.count=t.count,f.value=t.results}).finally(()=>{p.value=!1})}};V(()=>u.query,z),z();const B=()=>{const i={};n.value.related_problem__id?i.related_problem__id=n.value.related_problem__id:n.value.related_contest__id&&(i.related_contest__id=n.value.related_contest__id),J.push({name:"discussion_create",query:i})};return(i,t)=>{const v=P,m=W,D=d,I=X,T=R,h=Y,A=F,N=E;return C(),U(N,null,{default:l(()=>[te,a(h,null,{default:l(()=>[x("div",ae,[a(I,{inline:""},{default:l(()=>[a(m,{label:"\u6807\u9898"},{default:l(()=>[a(v,{value:n.value.search,"onUpdate:value":t[0]||(t[0]=o=>n.value.search=o),onKeydown:y(_(s),["enter"])},null,8,["value","onKeydown"])]),_:1}),a(m,{label:"\u5173\u8054\u9898\u76EEID"},{default:l(()=>[a(v,{value:n.value.related_problem__id,"onUpdate:value":t[1]||(t[1]=o=>n.value.related_problem__id=o),type:"number",onKeydown:y(_(s),["enter"])},null,8,["value","onKeydown"])]),_:1}),a(m,{label:"\u5173\u8054\u6BD4\u8D5B/\u9898\u5355ID"},{default:l(()=>[a(v,{value:n.value.related_contest__id,"onUpdate:value":t[2]||(t[2]=o=>n.value.related_contest__id=o),type:"number",onKeydown:y(_(s),["enter"])},null,8,["value","onKeydown"])]),_:1}),a(m,{label:"\u4F5C\u8005\u7528\u6237\u540D\u79F0"},{default:l(()=>[a(v,{value:n.value.author__username,"onUpdate:value":t[3]||(t[3]=o=>n.value.author__username=o),onKeydown:y(_(s),["enter"])},null,8,["value","onKeydown"])]),_:1}),a(m,null,{default:l(()=>[a(D,{type:"primary",onClick:_(s)},{default:l(()=>[K("\u641C\u7D22")]),_:1},8,["onClick"])]),_:1})]),_:1})]),a(D,{style:{float:"right","margin-top":"25px","margin-right":"10px"},type:"primary",onClick:B},{icon:l(()=>[a(T,{component:_(M)},null,8,["component"])]),default:l(()=>[K(" \u521B\u5EFA\u8BA8\u8BBA ")]),_:1})]),_:1}),a(h,null,{default:l(()=>[a(ee,{data:f.value,loading:p.value},null,8,["data","loading"])]),_:1}),a(h,null,{default:l(()=>[x("div",ne,[a(A,{page:e.value.page,"onUpdate:page":[t[4]||(t[4]=o=>e.value.page=o),_(s)],"page-size":e.value.pageSize,"onUpdate:pageSize":[t[5]||(t[5]=o=>e.value.pageSize=o),t[6]||(t[6]=o=>{e.value.pageSize=o,e.value.page=1,_(s)()})],"item-count":e.value.count,"show-size-picker":"","show-quick-jumper":"","page-sizes":[10,20,50]},null,8,["page","page-size","item-count","onUpdate:page"])])]),_:1})]),_:1})}}};export{ke as default};
